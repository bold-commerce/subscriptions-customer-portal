.vendor:
  stage: checkout
  image: $NODE_IMAGE
  interruptible: true
  script:
    - npm i
  cache:
    key:
      prefix: npm
      files:
        - package-lock.json
    paths:
      - node_modules/

vendor preview:
  extends: .vendor
  when: manual
  only:
    refs:
      - branches
  except:
    refs:
      - tags

vendor production:
  extends: .vendor
  when: always
  only:
    refs:
      - tags
